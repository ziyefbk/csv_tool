# 创建一个最小的 ICO 文件（16x16 单色图标）
# 这是一个最简单的有效 ICO 文件格式

$iconPath = "icon.ico"

# 最小的有效 ICO 文件（16x16，1位色深）
# ICO 文件头 + 图像目录 + 图像数据
$icoBytes = @(
    # ICO 文件头
    0x00, 0x00,  # 保留字段
    0x01, 0x00,  # 图像类型 (1 = ICO)
    0x01, 0x00,  # 图像数量
    
    # 图像目录条目
    0x10,        # 宽度 (16)
    0x10,        # 高度 (16)
    0x00,        # 调色板数量
    0x00,        # 保留
    0x01, 0x00,  # 颜色平面数
    0x01, 0x00,  # 每像素位数
    0x40, 0x00, 0x00, 0x00,  # 图像数据大小 (64 bytes)
    0x16, 0x00, 0x00, 0x00,  # 图像数据偏移量 (22 bytes)
    
    # BITMAPINFOHEADER (40 bytes)
    0x28, 0x00, 0x00, 0x00,  # 结构大小 (40)
    0x10, 0x00, 0x00, 0x00,  # 宽度 (16)
    0x20, 0x00, 0x00, 0x00,  # 高度 (32 = 16*2，包含掩码)
    0x01, 0x00,              # 颜色平面数
    0x01, 0x00,              # 每像素位数
    0x00, 0x00, 0x00, 0x00,  # 压缩方式
    0x00, 0x00, 0x00, 0x00,  # 图像大小
    0x00, 0x00, 0x00, 0x00,  # 水平分辨率
    0x00, 0x00, 0x00, 0x00,  # 垂直分辨率
    0x00, 0x00, 0x00, 0x00,  # 使用的颜色数
    0x00, 0x00, 0x00, 0x00,  # 重要颜色数
    
    # 图像数据 (16x16 1位 = 32 bytes) + 掩码 (16x16 1位 = 32 bytes)
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
    0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
)

[System.IO.File]::WriteAllBytes((Join-Path $PSScriptRoot $iconPath), $icoBytes)
Write-Host "图标文件已创建: $iconPath" -ForegroundColor Green

